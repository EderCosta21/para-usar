{"version":3,"sources":["ng://ion-bottom-drawer/modules/ion-bottom-drawer/ion-bottom-drawer.ts","ng://ion-bottom-drawer/modules/ion-bottom-drawer/ion-bottom-drawer.module.ts"],"names":["IonBottomDrawerComponent","_element","_renderer","_domCtrl","_platform","this","DrawerState","Bottom","EventEmitter","prototype","ngAfterViewInit","_this","setStyle","nativeElement","querySelector","_setDrawerState","state","hammer","Hammer","get","set","enable","direction","DIRECTION_VERTICAL","on","ev","disableDrag","type","_handlePanStart","_handlePanEnd","_handlePan","ngOnChanges","changes","currentValue","transition","_setTranslateY","minimumHeight","Docked","height","dockedHeight","distanceTop","_startPositionTop","getBoundingClientRect","top","shouldBounce","isFinal","_handleDockedPanEnd","Top","_handleTopPanEnd","_handleBottomPanEnd","stateChange","emit","deltaY","_BOUNCE_DELTA","absDeltaY","Math","abs","pointerY","center","y","additionalEvent","newTop","value","write","Component","args","selector","template","styles","ElementRef","Renderer2","DomController","Platform","Input","Output","IonBottomDrawerModule","NgModule","declarations","imports","IonicModule","exports"],"mappings":"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","sourcesContent":["import { Component, Input, ElementRef, Renderer2, Output, EventEmitter, AfterViewInit, OnChanges, SimpleChanges } from '@angular/core';\nimport { Platform, DomController } from 'ionic-angular';\n\nimport { DrawerState } from './drawer-state';\n\n@Component({\n  selector: 'ion-bottom-drawer',\n  template: `<ion-content class=\"ion-bottom-drawer-scrollable-content\" no-bounce>\n  <ng-content></ng-content>\n</ion-content>\n`,\n  styles: [`:host{width:100%;height:100%;position:absolute;left:0;z-index:11!important;background-color:#fff;-webkit-transform:translateY(100vh);transform:translateY(100vh)}`]\n})\nexport class IonBottomDrawerComponent implements AfterViewInit, OnChanges {\n  @Input() dockedHeight: number = 50;\n\n  @Input() shouldBounce: boolean = true;\n\n  @Input() disableDrag: boolean = false;\n\n  @Input() distanceTop: number = 0;\n\n  @Input() transition: string = '0.25s ease-in-out';\n\n  @Input() state: DrawerState = DrawerState.Bottom;\n\n  @Input() minimumHeight: number = 0;\n\n  @Output() stateChange: EventEmitter<DrawerState> = new EventEmitter<DrawerState>();\n\n  private _startPositionTop: number;\n  private readonly _BOUNCE_DELTA = 30;\n\n  constructor(\n    private _element: ElementRef,\n    private _renderer: Renderer2,\n    private _domCtrl: DomController,\n    private _platform: Platform\n  ) { }\n\n  ngAfterViewInit() {\n    this._renderer.setStyle(this._element.nativeElement.querySelector('.ion-bottom-drawer-scrollable-content .scroll-content'), 'touch-action', 'none');\n    this._setDrawerState(this.state);\n\n    const hammer = new Hammer(this._element.nativeElement);\n    hammer.get('pan').set({ enable: true, direction: Hammer.DIRECTION_VERTICAL });\n    hammer.on('pan panstart panend', (ev: any) => {\n      if (this.disableDrag) return;\n\n      switch (ev.type) {\n        case 'panstart':\n          this._handlePanStart();\n          break;\n        case 'panend':\n          this._handlePanEnd(ev);\n          break;\n        default:\n          this._handlePan(ev);\n      }\n    });\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (!changes.state) return;\n    this._setDrawerState(changes.state.currentValue);\n  }\n\n  private _setDrawerState(state: DrawerState) {\n    this._renderer.setStyle(this._element.nativeElement, 'transition', this.transition);\n    switch (state) {\n      case DrawerState.Bottom:\n        this._setTranslateY('calc(100vh - ' + this.minimumHeight + 'px)');\n        break;\n      case DrawerState.Docked:\n        this._setTranslateY((this._platform.height() - this.dockedHeight) + 'px');\n        break;\n      default:\n        this._setTranslateY(this.distanceTop + 'px');\n    }\n  }\n\n  private _handlePanStart() {\n    this._startPositionTop = this._element.nativeElement.getBoundingClientRect().top;\n  }\n\n  private _handlePanEnd(ev) {\n    if (this.shouldBounce && ev.isFinal) {\n      this._renderer.setStyle(this._element.nativeElement, 'transition', this.transition);\n\n      switch (this.state) {\n        case DrawerState.Docked:\n          this._handleDockedPanEnd(ev);\n          break;\n        case DrawerState.Top:\n          this._handleTopPanEnd(ev);\n          break;\n        default:\n          this._handleBottomPanEnd(ev);\n      }\n    }\n    this.stateChange.emit(this.state);\n  }\n\n  private _handleTopPanEnd(ev) {\n    if (ev.deltaY > this._BOUNCE_DELTA) {\n      this.state = DrawerState.Docked;\n    } else {\n      this._setTranslateY(this.distanceTop + 'px');\n    }\n  }\n\n  private _handleDockedPanEnd(ev) {\n    const absDeltaY = Math.abs(ev.deltaY)\n    if (absDeltaY > this._BOUNCE_DELTA && ev.deltaY < 0) {\n      this.state = DrawerState.Top;\n    } else if (absDeltaY > this._BOUNCE_DELTA && ev.deltaY > 0) {\n      this.state = DrawerState.Bottom\n    } else {\n      this._setTranslateY((this._platform.height() - this.dockedHeight) + 'px');\n    }\n  }\n\n  private _handleBottomPanEnd(ev) {\n    if (-ev.deltaY > this._BOUNCE_DELTA) {\n      this.state = DrawerState.Docked;\n    } else {\n      this._setTranslateY('calc(100vh - ' + this.minimumHeight + 'px)');\n    }\n  }\n\n  private _handlePan(ev) {\n    const pointerY = ev.center.y;\n    this._renderer.setStyle(this._element.nativeElement, 'transition', 'none');\n    if (pointerY > 0 && pointerY < this._platform.height()) {\n      if (ev.additionalEvent === 'panup' || ev.additionalEvent === 'pandown') {\n        const newTop = this._startPositionTop + ev.deltaY;\n        if (newTop >= this.distanceTop) this._setTranslateY(newTop + 'px');\n        else if (newTop < this.distanceTop) this._setTranslateY(this.distanceTop + 'px');\n        if (newTop > this._platform.height() - this.minimumHeight) this._setTranslateY((this._platform.height() - this.minimumHeight) + 'px');\n      }\n    }\n  }\n\n  private _setTranslateY(value) {\n    this._domCtrl.write(() => {\n      this._renderer.setStyle(this._element.nativeElement, 'transform', 'translateY(' + value + ')');\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { IonicModule } from 'ionic-angular';\nimport { IonBottomDrawerComponent } from './ion-bottom-drawer';\n\n@NgModule({\n  declarations: [IonBottomDrawerComponent],\n  imports: [IonicModule],\n  exports: [IonBottomDrawerComponent]\n})\nexport class IonBottomDrawerModule { }\n"]}